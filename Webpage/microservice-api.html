<!DOCTYPE html>
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
	<meta charset="UTF-8">
	<meta name="google" content="notranslate">
	<meta http-equiv="Content-Language" content="en">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>MicroService API Request</title>
	<link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3E%3Cpath fill='%23436BFE' d='M266.3 48.3L232.5 73.6c-5.4 4-8.5 10.4-8.5 17.1v9.1c0 6.8 5.5 12.3 12.3 12.3c2.4 0 4.8-.7 6.8-2.1l41.8-27.9c2-1.3 4.4-2.1 6.8-2.1h1c6.2 0 11.3 5.1 11.3 11.3c0 3-1.2 5.9-3.3 8l-19.9 19.9c-5.8 5.8-12.9 10.2-20.7 12.8l-26.5 8.8c-5.8 1.9-9.6 7.3-9.6 13.4c0 3.7-1.5 7.3-4.1 10l-17.9 17.9c-6.4 6.4-9.9 15-9.9 24v4.3c0 16.4 13.6 29.7 29.9 29.7c11 0 21.2-6.2 26.1-16l4-8.1c2.4-4.8 7.4-7.9 12.8-7.9c4.5 0 8.7 2.1 11.4 5.7l16.3 21.7c2.1 2.9 5.5 4.5 9.1 4.5c8.4 0 13.9-8.9 10.1-16.4l-1.1-2.3c-3.5-7 0-15.5 7.5-18l21.2-7.1c7.6-2.5 12.7-9.6 12.7-17.6c0-10.3 8.3-18.6 18.6-18.6H400c8.8 0 16 7.2 16 16s-7.2 16-16 16H379.3c-7.2 0-14.2 2.9-19.3 8l-4.7 4.7c-2.1 2.1-3.3 5-3.3 8c0 6.2 5.1 11.3 11.3 11.3h11.3c6 0 11.8 2.4 16 6.6l6.5 6.5c1.8 1.8 2.8 4.3 2.8 6.8s-1 5-2.8 6.8l-7.5 7.5C386 262 384 266.9 384 272s2 10 5.7 13.7L408 304c10.2 10.2 24.1 16 38.6 16H454c6.5-20.2 10-41.7 10-64c0-111.4-87.6-202.4-197.7-207.7zm172 307.9c-3.7-2.6-8.2-4.1-13-4.1c-6 0-11.8-2.4-16-6.6L396 332c-7.7-7.7-18-12-28.9-12c-9.7 0-19.2-3.5-26.6-9.8L314 287.4c-11.6-9.9-26.4-15.4-41.7-15.4H251.4c-12.6 0-25 3.7-35.5 10.7L188.5 301c-17.8 11.9-28.5 31.9-28.5 53.3v3.2c0 17 6.7 33.3 18.7 45.3l16 16c8.5 8.5 20 13.3 32 13.3H248c13.3 0 24 10.7 24 24c0 2.5 .4 5 1.1 7.3c71.3-5.8 132.5-47.6 165.2-107.2zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zM187.3 100.7c-6.2-6.2-16.4-6.2-22.6 0l-32 32c-6.2 6.2-6.2 16.4 0 22.6s16.4 6.2 22.6 0l32-32c6.2-6.2 6.2-16.4 0-22.6z'/%3E%3C/svg%3E" />
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<body>

	<div class="container-fluid bg-primary py-5 border-bottom border-black">
		<div class="container py-3">
			<div class="row">
				<h4><i class="fa-solid fa-network-wired me-1"></i>MicroService API Request</h4>
			</div>
		</div>
	</div>
	<div class="container-fluid py-5">
		<div class="container py-5">
			<div class="row">
				<div class="col">
					<div id="alert" class="alert alert-danger alert-dismissible d-flex align-items-center d-none" role="alert">
						<i class="fa-solid fa-triangle-exclamation me-2"></i>
						<div>
							Fill in the missing form values and try again.
						</div>
						<button onclick="dismissAlert()" type="button" class="btn-close" aria-label="Close"></button>
					</div>
					<form id="api-form">
						<h6>Encryption</h6>
						<div class="input-group my-3">
							<span class="input-group-text justify-content-center" style="min-width:3rem"><i class="fa-solid fa-font"></i></span>
							<div class="form-floating">
								<input type="text" class="form-control" id="input-text" placeholder="Text" required>
								<label for="input-text">Text</label>
							</div>
						</div>
						<div class="input-group mb-3">
							<span class="input-group-text justify-content-center" style="min-width:3rem"><i class="fa-solid fa-key"></i></span>
							<div class="form-floating">
								<input type="password" class="form-control" id="input-key" placeholder="Key" required>
								<label for="input-key">Key</label>
							</div>
						</div>
						<hr class="my-4" style="border-top: dotted 1px;" />
						<h6>Options</h6>
						<div class="input-group input-group-lg my-3">
							<label class="input-group-text" for="select-algorithm">Algorithm</label>
							<select class="form-select" id="select-algorithm">
								<option value="AES" selected>AES</option>
								<option value="DES">DES</option>
								<option value="RC2">RC2</option>
								<option value="TripleDES">TripleDES</option>
							</select>
						</div>
						<div class="input-group mx-2">
							<div class="form-check form-check-inline">
								<input class="form-check-input" type="radio" name="inlineRadioOptions" id="radio-encrypt" value="Encrypt" checked>
								<label class="form-check-label" for="radio-encrypt">Encrypt</label>
							</div>
							<div class="form-check form-check-inline">
								<input class="form-check-input" type="radio" name="inlineRadioOptions" id="radio-decrypt" value="Decrypt">
								<label class="form-check-label" for="radio-decrypt">Decrypt</label>
							</div>
						</div>
						<hr class="my-4" style="border-top: dotted 1px;" />
						<div class="input-group mx-1">
							<button id="btn-submit" class="btn btn-primary" type="button">
								<span id="btn-spinner" class="spinner-border spinner-border-sm d-none" aria-hidden="true"></span>
								<span id="btn-icon"><i class="fa-solid fa-paper-plane"></i></span>
								<span id="btn-label" role="status">Submit</span>
							</button>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>
	<div id="api-response-section" class="container-fluid bg-light py-5 border-top border-bottom d-none">
		<div class="container py-5">
			<div class="row">
				<div class="col">
					<div class="mb-3">
						<label for="text-area-response" class="form-label">API Response:</label>
						<textarea id="api-response-data" class="form-control" id="text-area-response" rows="6" disabled></textarea>
					</div>
				</div>
			</div>
		</div>
	</div>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
	<script>

		function setup() {
			var submit = document.getElementById('btn-submit');
			var form = document.getElementById('api-form');
			var alert = document.getElementById('alert');

			submit.addEventListener('click', event => {
				if (!form.checkValidity()) {
					event.preventDefault();
					event.stopPropagation();
					alert.classList.remove('d-none');
					form.classList.add('was-validated');
				} else {
					alert.classList.add('d-none');
					form.classList.remove('was-validated');
					apiLookup();
				}
			});
		}

		function apiLookup() {
			loading();

			var xhr = new XMLHttpRequest();
			var requestUrl = buildUrl();
			console.log(requestUrl);

			xhr.open('POST', requestUrl, true);
			xhr.onload = function () {
				if (xhr.status >= 200 && xhr.status < 300) {
					loaded(xhr.responseText);
				} else {
					loaded(xhr.status);
				}
			};

			xhr.onerror = function () {
				loaded('Network error occurred');
			};

			xhr.send();
		}

		function buildUrl() {
			var action = document.getElementById('radio-decrypt').checked ? "DecryptString" : "EncryptString";
			var algorithm = document.getElementById('select-algorithm').value;
			var value = encodeURIComponent(document.getElementById('input-text').value);
			var key = encodeURIComponent(document.getElementById('input-key').value);
			var url = `http://<ubuntu-eth0-ip>:5000/api/Encryption/${action}?encryptionMethod=${algorithm}&value=${value}&key=${key}`;

			return url;
		}

		function loading() {
			var button = document.getElementById('btn-submit');
			var spinner = document.getElementById('btn-spinner');
			var icon = document.getElementById('btn-icon');
			var label = document.getElementById('btn-label');
			button.disabled = true;
			icon.classList.add('d-none');
			spinner.classList.remove('d-none');
			label.innerHTML = "Loading...";
		}

		function loaded(responseText) {
			var jsonData = JSON.parse(responseText);
			var container = document.getElementById('api-response-section');
			var textArea = document.getElementById('api-response-data');
			var button = document.getElementById('btn-submit');
			var spinner = document.getElementById('btn-spinner');
			var icon = document.getElementById('btn-icon');
			var label = document.getElementById('btn-label');
			button.disabled = false;
			icon.classList.remove('d-none');
			spinner.classList.add('d-none');
			label.innerHTML = "Submit";
			textArea.innerHTML = JSON.stringify(jsonData, null, 4);
			container.classList.remove('d-none');
		}

		function dismissAlert() {
			var alert = document.getElementById('alert');
			alert.classList.add('d-none');
		}

		setup()
	</script>

</body>

</html>